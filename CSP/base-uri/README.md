# CSP base-uri 指令演示

这个演示展示了 `base-uri` 内容安全策略指令的用法，它限制 `<base>` 标签中指定的 URL。


## base 必知必会
- <base> 必须放在 <head> 中，且只能有一个。
- 如果设置了 ```<base href>```，那么文档中所有相对路径都会受到影响，包括：
  - ```<a href="...">```
  - ```<img src="...">```
  - ```<script src="...">```
  - ```<link href="...">（如样式表）```

开发中使用 <base> 要小心，因为它会全局影响路径解析，容易导致资源加载出错。

## 说明

`<base>` 标签用于为页面上的所有相对 URL 指定基本 URL。如果不受限制，这可能导致安全问题，因为攻击者可以通过注入 `<base>` 标签来重定向资源请求或导航。

这个演示提供了三个不同的页面配置:

1. **受限版** (`base-uri 'self'`):
   - 只允许设置指向同源的 base 标签
   - 尝试设置指向外部域名的 base 标签会被阻止

2. **无限制版** (没有 base-uri 限制):
   - 没有对 base 标签的限制
   - 可以设置指向任何 URL 的 base 标签
   - 展示了缺少此限制的安全风险

3. **完全禁止版** (`base-uri 'none'`):
   - 禁止所有 base 标签，无论指向哪里
   - 提供最高级别的安全保护

## 运行方法

1. 确保安装了依赖:
```
npm install
```

2. 启动服务器:
```
node server.js
```

3. 打开浏览器访问:
   - 受限版: http://localhost:3006
   - 无限制版: http://localhost:3006/unrestricted
   - 完全禁止版: http://localhost:3006/blocked

## 演示内容

每个页面都提供两个测试按钮:

1. **添加同源 Base 标签**:
   - 尝试添加指向 `/base/` 的 base 标签
   - 在受限版中允许，在完全禁止版中会被阻止

2. **添加外部域名 Base 标签**:
   - 尝试添加指向 `https://example.com/` 的 base 标签
   - 在受限版和完全禁止版中会被阻止，在无限制版中允许

添加 base 标签后，页面会显示:
- 当前的 base URI
- 相对链接如何被解析

## base-uri 的安全意义

- **防止重定向攻击**: 阻止攻击者通过注入 base 标签来改变相对链接的行为
- **保护资源加载**: 确保脚本、样式表和图像等资源不会被重定向到恶意服务器
- **保护表单提交**: 阻止表单数据被提交到攻击者控制的服务器
- **预防钓鱼攻击**: 防止用户点击的链接被重定向到钓鱼网站

## 最佳实践

- 如果网站不使用 base 标签: 设置 `base-uri 'none'`
- 如果只使用同源 base URL: 设置 `base-uri 'self'`
- 如果需要使用外部 base URL: 明确列出允许的域名 